Time = factor(time_points, levels = time_points),
AGuIX = c(
1.085,
0.744,
0.88,
1.081,
0.684
),
Dotarem = c(
0.185855,
0.447886,
0.61282,
0.410464,
0.166528
),
Sig1 = c(0.03336,	0.3552,	0.09375,	0.004024,	0.125
)
)
IVC_aguix_error <- c(0.53,
0.2,
0.34,
0.27,
0.402
)
IVC_dotarem_error <- c(1.016785,
0.80807,
0.366304,
0.21657,
0.1348416
)
Aorta_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
0.366,
1.052,
1.603,
2.179,
1.495
),
Dotarem = c(
-0.016428,
0.522012,
1.2681,
0.792156,
0.494628
),
Sig2 = c(0.03721,	0.2381,	0.002594,	0.0000983,	0.02471
)
)
aorta_aguix_error <- c(0.211,
0.683,
0.3987,
0.412,
0.706
)
aorta_dotarem_error <- c(
0.2621228,
0.808216,
0.403676,
0.1955348,
0.257254
)
# Reshape data for plotting and include Sig as part of the long data
IVC_long <- pivot_longer(IVC_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig1, Sig1),
Error = ifelse(Agent == "AGuIX", IVC_aguix_error, IVC_dotarem_error))
Aorta_long <- pivot_longer(Aorta_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig2, Sig2),
Error = ifelse(Agent == "AGuIX", aorta_aguix_error, aorta_dotarem_error))
# Combine datasets
combined_data <- bind_rows(IVC_long, Aorta_long) %>%
mutate(Location = rep(c("Cortex", "Medulla"), each = 10))
# Plot
gg <- ggplot(combined_data, aes(x = Time, y = Signal, fill = Agent)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_errorbar(aes(ymin = pmax(Signal - Error, 0.0), ymax = Signal + Error), width = 0.2, position = position_dodge(width = 0.7)) +
scale_fill_manual(values = c("AGuIX" = "lightblue", "Dotarem" = "gold")) +
facet_wrap(~Location, scales = "free_y") +
labs(x = "Time (min)", y = "[Gd] (mg/mL)") +
theme_minimal() +
theme(
text = element_text(family = font_family),
plot.title = element_text(size = font_size_title, face = "bold", hjust = 0.5),
axis.title = element_text(size = font_size_axis_title),
axis.text = element_text(size = font_size_text),
axis.text.x = element_text(angle = 35, hjust = 1),
legend.title = element_blank(),
legend.text = element_text(size = 35),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text = element_text(size = font_size_facet, face = "bold"),
axis.line = element_line(color = "black", size = 1)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits = function(x) c(0, 6)) +
geom_vline(xintercept = c(2.5, 4.5), linetype = "dotted", color = "black") +
geom_text(data = filter(combined_data, Location == "Cortex"), aes(x = Inf, y = Inf, label = "Global p < 0.01**"), vjust = 1.65, hjust = 2.35, color = "red", size = 12)+
geom_text(data = filter(combined_data, Location == "Medulla"), aes(x = Inf, y = Inf, label = "Global p < 0.05*"), vjust = 1.65, hjust = 2.35, color = "red", size = 12)+
geom_hline(yintercept = 0.2, linetype = "dotted", color = "black", size = 1.5 )
print(gg)
ggsave("output_plot.png", plot = gg, width = 9000, height = 2500, units = "px")
# Define the corrected data without timepoint 1
time_points <- c(0.11, 0.5, 1, 3, 10)
IVC_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
1.085,
0.744,
0.88,
1.081,
0.684
),
Dotarem = c(
0.185855,
0.447886,
0.61282,
0.410464,
0.166528
),
Sig1 = c(0.03336,	0.3552,	0.09375,	0.004024,	0.125
)
)
IVC_aguix_error <- c(0.53,
0.2,
0.34,
0.27,
0.402
)
IVC_dotarem_error <- c(1.016785,
0.80807,
0.366304,
0.21657,
0.1348416
)
Aorta_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
0.366,
1.052,
1.603,
2.179,
1.495
),
Dotarem = c(
-0.016428,
0.522012,
1.2681,
0.792156,
0.494628
),
Sig2 = c(0.03721,	0.2381,	0.002594,	0.0000983,	0.02471
)
)
aorta_aguix_error <- c(0.211,
0.683,
0.3987,
0.412,
0.706
)
aorta_dotarem_error <- c(
0.2621228,
0.808216,
0.403676,
0.1955348,
0.257254
)
# Reshape data for plotting and include Sig as part of the long data
IVC_long <- pivot_longer(IVC_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig1, Sig1),
Error = ifelse(Agent == "AGuIX", IVC_aguix_error, IVC_dotarem_error))
Aorta_long <- pivot_longer(Aorta_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig2, Sig2),
Error = ifelse(Agent == "AGuIX", aorta_aguix_error, aorta_dotarem_error))
# Combine datasets
combined_data <- bind_rows(IVC_long, Aorta_long) %>%
mutate(Location = rep(c("Cortex", "Medulla"), each = 10))
# Plot
gg <- ggplot(combined_data, aes(x = Time, y = Signal, fill = Agent)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_errorbar(aes(ymin = pmax(Signal - Error, 0.0), ymax = Signal + Error), width = 0.2, position = position_dodge(width = 0.7)) +
scale_fill_manual(values = c("AGuIX" = "lightblue", "Dotarem" = "gold")) +
facet_wrap(~Location, scales = "free_y") +
labs(x = "Time (min)", y = "[Gd] (mg/mL)") +
theme_minimal() +
theme(
text = element_text(family = font_family),
plot.title = element_text(size = font_size_title, face = "bold", hjust = 0.5),
axis.title = element_text(size = font_size_axis_title),
axis.text = element_text(size = font_size_text),
axis.text.x = element_text(angle = 35, hjust = 1),
legend.title = element_blank(),
legend.text = element_text(size = 35),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text = element_text(size = font_size_facet, face = "bold"),
axis.line = element_line(color = "black", size = 1)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits = function(x) c(0, 6)) +
geom_vline(xintercept = c(2.5, 4.5), linetype = "dotted", color = "black") +
geom_text(data = filter(combined_data, Location == "Cortex"), aes(x = Inf, y = Inf, label = "Global p < 0.01**"), vjust = 1.65, hjust = 2.15, color = "red", size = 12)+
geom_text(data = filter(combined_data, Location == "Medulla"), aes(x = Inf, y = Inf, label = "Global p < 0.05*"), vjust = 1.65, hjust = 2.35, color = "red", size = 12)+
geom_hline(yintercept = 0.2, linetype = "dotted", color = "black", size = 1.5 )
print(gg)
ggsave("output_plot.png", plot = gg, width = 9000, height = 2500, units = "px")
# Define the corrected data without timepoint 1
time_points <- c(0.11, 0.5, 1, 3, 10)
IVC_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
1.085,
0.744,
0.88,
1.081,
0.684
),
Dotarem = c(
0.185855,
0.447886,
0.61282,
0.410464,
0.166528
),
Sig1 = c(0.03336,	0.3552,	0.09375,	0.004024,	0.125
)
)
IVC_aguix_error <- c(0.53,
0.2,
0.34,
0.27,
0.402
)
IVC_dotarem_error <- c(1.016785,
0.80807,
0.366304,
0.21657,
0.1348416
)
Aorta_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
0.366,
1.052,
1.603,
2.179,
1.495
),
Dotarem = c(
-0.016428,
0.522012,
1.2681,
0.792156,
0.494628
),
Sig2 = c(0.03721,	0.2381,	0.002594,	0.0000983,	0.02471
)
)
aorta_aguix_error <- c(0.211,
0.683,
0.3987,
0.412,
0.706
)
aorta_dotarem_error <- c(
0.2621228,
0.808216,
0.403676,
0.1955348,
0.257254
)
# Reshape data for plotting and include Sig as part of the long data
IVC_long <- pivot_longer(IVC_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig1, Sig1),
Error = ifelse(Agent == "AGuIX", IVC_aguix_error, IVC_dotarem_error))
Aorta_long <- pivot_longer(Aorta_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig2, Sig2),
Error = ifelse(Agent == "AGuIX", aorta_aguix_error, aorta_dotarem_error))
# Combine datasets
combined_data <- bind_rows(IVC_long, Aorta_long) %>%
mutate(Location = rep(c("Cortex", "Medulla"), each = 10))
# Plot
gg <- ggplot(combined_data, aes(x = Time, y = Signal, fill = Agent)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_errorbar(aes(ymin = pmax(Signal - Error, 0.0), ymax = Signal + Error), width = 0.2, position = position_dodge(width = 0.7)) +
scale_fill_manual(values = c("AGuIX" = "lightblue", "Dotarem" = "gold")) +
facet_wrap(~Location, scales = "free_y") +
labs(x = "Time (min)", y = "[Gd] (mg/mL)") +
theme_minimal() +
theme(
text = element_text(family = font_family),
plot.title = element_text(size = font_size_title, face = "bold", hjust = 0.5),
axis.title = element_text(size = font_size_axis_title),
axis.text = element_text(size = font_size_text),
axis.text.x = element_text(angle = 35, hjust = 1),
legend.title = element_blank(),
legend.text = element_text(size = 35),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text = element_text(size = font_size_facet, face = "bold"),
axis.line = element_line(color = "black", size = 1)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits = function(x) c(0, 4)) +
geom_vline(xintercept = c(2.5, 4.5), linetype = "dotted", color = "black") +
geom_text(data = filter(combined_data, Location == "Cortex"), aes(x = Inf, y = Inf, label = "Global p < 0.01**"), vjust = 1.65, hjust = 2.15, color = "red", size = 12)+
geom_text(data = filter(combined_data, Location == "Medulla"), aes(x = Inf, y = Inf, label = "Global p < 0.05*"), vjust = 1.65, hjust = 2.35, color = "red", size = 12)+
geom_hline(yintercept = 0.2, linetype = "dotted", color = "black", size = 1.5 )
print(gg)
ggsave("output_plot.png", plot = gg, width = 9000, height = 2500, units = "px")
# Define the corrected data without timepoint 1
time_points <- c(0.11, 0.5, 1, 3, 10)
IVC_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
1.085,
0.744,
0.88,
1.081,
0.684
),
Dotarem = c(
0.185855,
0.447886,
0.61282,
0.410464,
0.166528
),
Sig1 = c(0.03336,	0.3552,	0.09375,	0.004024,	0.125
)
)
IVC_aguix_error <- c(0.53,
0.2,
0.34,
0.27,
0.402
)
IVC_dotarem_error <- c(1.016785,
0.80807,
0.366304,
0.21657,
0.1348416
)
Aorta_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
0.366,
1.052,
1.603,
2.179,
1.495
),
Dotarem = c(
-0.016428,
0.522012,
1.2681,
0.792156,
0.494628
),
Sig2 = c(0.03721,	0.2381,	0.002594,	0.0000983,	0.02471
)
)
aorta_aguix_error <- c(0.211,
0.683,
0.3987,
0.412,
0.706
)
aorta_dotarem_error <- c(
0.2621228,
0.808216,
0.403676,
0.1955348,
0.257254
)
# Reshape data for plotting and include Sig as part of the long data
IVC_long <- pivot_longer(IVC_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig1, Sig1),
Error = ifelse(Agent == "AGuIX", IVC_aguix_error, IVC_dotarem_error))
Aorta_long <- pivot_longer(Aorta_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig2, Sig2),
Error = ifelse(Agent == "AGuIX", aorta_aguix_error, aorta_dotarem_error))
# Combine datasets
combined_data <- bind_rows(IVC_long, Aorta_long) %>%
mutate(Location = rep(c("Cortex", "Medulla"), each = 10))
# Plot
gg <- ggplot(combined_data, aes(x = Time, y = Signal, fill = Agent)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_errorbar(aes(ymin = pmax(Signal - Error, 0.0), ymax = Signal + Error), width = 0.2, position = position_dodge(width = 0.7)) +
scale_fill_manual(values = c("AGuIX" = "lightblue", "Dotarem" = "gold")) +
facet_wrap(~Location, scales = "free_y") +
labs(x = "Time (min)", y = "[Gd] (mg/mL)") +
theme_minimal() +
theme(
text = element_text(family = font_family),
plot.title = element_text(size = font_size_title, face = "bold", hjust = 0.5),
axis.title = element_text(size = font_size_axis_title),
axis.text = element_text(size = font_size_text),
axis.text.x = element_text(angle = 35, hjust = 1),
legend.title = element_blank(),
legend.text = element_text(size = 35),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text = element_text(size = font_size_facet, face = "bold"),
axis.line = element_line(color = "black", size = 1)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits = function(x) c(0, 2.5)) +
geom_vline(xintercept = c(2.5, 4.5), linetype = "dotted", color = "black") +
geom_text(data = filter(combined_data, Location == "Cortex"), aes(x = Inf, y = Inf, label = "Global p < 0.01**"), vjust = 1.65, hjust = 2.15, color = "red", size = 12)+
geom_text(data = filter(combined_data, Location == "Medulla"), aes(x = Inf, y = Inf, label = "Global p < 0.05*"), vjust = 1.65, hjust = 2.35, color = "red", size = 12)+
geom_hline(yintercept = 0.2, linetype = "dotted", color = "black", size = 1.5 )
print(gg)
ggsave("output_plot.png", plot = gg, width = 9000, height = 2500, units = "px")
# Define the corrected data without timepoint 1
time_points <- c(0.11, 0.5, 1, 3, 10)
IVC_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
1.085,
0.744,
0.88,
1.081,
0.684
),
Dotarem = c(
0.185855,
0.447886,
0.61282,
0.410464,
0.166528
),
Sig1 = c(0.03336,	0.3552,	0.09375,	0.004024,	0.125
)
)
IVC_aguix_error <- c(0.53,
0.2,
0.34,
0.27,
0.402
)
IVC_dotarem_error <- c(1.016785,
0.80807,
0.366304,
0.21657,
0.1348416
)
Aorta_data <- data.frame(
Time = factor(time_points, levels = time_points),
AGuIX = c(
0.366,
1.052,
1.603,
2.179,
1.495
),
Dotarem = c(
-0.016428,
0.522012,
1.2681,
0.792156,
0.494628
),
Sig2 = c(0.03721,	0.2381,	0.002594,	0.0000983,	0.02471
)
)
aorta_aguix_error <- c(0.211,
0.683,
0.3987,
0.412,
0.706
)
aorta_dotarem_error <- c(
0.2621228,
0.808216,
0.403676,
0.1955348,
0.257254
)
# Reshape data for plotting and include Sig as part of the long data
IVC_long <- pivot_longer(IVC_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig1, Sig1),
Error = ifelse(Agent == "AGuIX", IVC_aguix_error, IVC_dotarem_error))
Aorta_long <- pivot_longer(Aorta_data, cols = c(AGuIX, Dotarem), names_to = "Agent", values_to = "Signal") %>%
mutate(Sig = ifelse(Agent == "AGuIX", Sig2, Sig2),
Error = ifelse(Agent == "AGuIX", aorta_aguix_error, aorta_dotarem_error))
# Combine datasets
combined_data <- bind_rows(IVC_long, Aorta_long) %>%
mutate(Location = rep(c("Cortex", "Medulla"), each = 10))
# Plot
gg <- ggplot(combined_data, aes(x = Time, y = Signal, fill = Agent)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_errorbar(aes(ymin = pmax(Signal - Error, 0.0), ymax = Signal + Error), width = 0.2, position = position_dodge(width = 0.7)) +
scale_fill_manual(values = c("AGuIX" = "lightblue", "Dotarem" = "gold")) +
facet_wrap(~Location, scales = "free_y") +
labs(x = "Time (min)", y = "[Gd] (mg/mL)") +
theme_minimal() +
theme(
text = element_text(family = font_family),
plot.title = element_text(size = font_size_title, face = "bold", hjust = 0.5),
axis.title = element_text(size = font_size_axis_title),
axis.text = element_text(size = font_size_text),
axis.text.x = element_text(angle = 35, hjust = 1),
legend.title = element_blank(),
legend.text = element_text(size = 35),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text = element_text(size = font_size_facet, face = "bold"),
axis.line = element_line(color = "black", size = 1)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits = function(x) c(0, 3)) +
geom_vline(xintercept = c(2.5, 4.5), linetype = "dotted", color = "black") +
geom_text(data = filter(combined_data, Location == "Cortex"), aes(x = Inf, y = Inf, label = "Global p < 0.01**"), vjust = 1.65, hjust = 2.15, color = "red", size = 12)+
geom_text(data = filter(combined_data, Location == "Medulla"), aes(x = Inf, y = Inf, label = "Global p < 0.05*"), vjust = 1.65, hjust = 2.35, color = "red", size = 12)+
geom_hline(yintercept = 0.2, linetype = "dotted", color = "black", size = 1.5 )
print(gg)
ggsave("output_plot.png", plot = gg, width = 9000, height = 2500, units = "px")
