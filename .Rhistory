type = "gd"
)
plotOrganDataBars <- function(data_list, title, ylab, y_breaks, type) {
# Prepare the time points; ensure these match your actual time points
time_points <- c(0.11, 0.5, 1, 3, 10)
# Create the plot data by combining all organ data frames and adding an 'Organ' column
plot_data <- do.call(rbind, lapply(names(data_list), function(org) {
df <- data_list[[org]]
df$Organ <- org
transform(df, TimePoint = factor(t, levels = as.character(time_points)))
}))
# Determine the columns to plot based on 'type'
signal <- ifelse(type == "Gd", "gd", "hu")
std <- ifelse(type == "Gd", "gd_std", "hu_std")
# Create the plot
gg <- ggplot(plot_data, aes_string(x = "TimePoint", y = signal, fill = "Organ")) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_errorbar(aes_string(ymin = paste(signal, "-", std), ymax = paste(signal, "+", std)),
width = 0.2, position = position_dodge(width = 0.7)) +
scale_fill_manual(values = c("Pancreas" = "cyan", "Spleen" = "hotpink", "Liver" = "gold")) +
labs(title = title, x = "Time (min)", y = ylab) +
scale_y_continuous(expand = expansion(mult = c(0.003, 0.006)), breaks = y_breaks) +
theme_minimal() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(hjust = 0.5, size = 24),
legend.title = element_blank(),
axis.line = element_line(color="black", linewidth = 1),
axis.ticks = element_line(color = "black"),
axis.title = element_text(size = 32),
panel.border = element_blank(),
axis.title.y = element_text(size = 24, margin = margin(r = 20)),
axis.title.x = element_text(size = 24, margin = margin(t = 20)),
panel.background = element_rect(fill = "white"),
axis.text.x = element_text(size = 24),
axis.text = element_text(size = 24, margin = margin(r = 20), face = "bold")
)
# Print the plot
print(gg)
}
# Example usage
plotOrganDataBars(
data_list = list(Pancreas = pancreas, Spleen = spleen, Liver = liver),
title = "Organ Signal Intensity Over Time",
ylab = "Signal Intensity (based on type selected)",
y_breaks = seq(0, 2, by = 0.2),  # Adjust y_breaks according to the actual range of your data
type = "Gd"
)
# Example usage
plotOrganDataBars(
data_list = list(Pancreas = pancreas, Spleen = spleen, Liver = liver),
title = "Gd K-edge Organ Enhancement",
ylab = "Hounsfield Units (HU)",
y_breaks = seq(-500, 500, by = 50),  # Adjust y_breaks according to the actual range of your data
type = "HU"
)
# Example usage
plotOrganDataBars(
data_list = list(Pancreas = pancreas, Spleen = spleen, Liver = liver),
title = "Gd K-edge Organ Enhancement",
ylab = "[Gd] (mg/mL)",
y_breaks = seq(0, 2, by = 0.2),  # Adjust y_breaks according to the actual range of your data
type = "Gd"
)
# Example usage
plotOrganDataBars(
data_list = list(Pancreas = pancreas, Spleen = spleen, Liver = liver),
title = "Conventional Organ Enhancement",
ylab = "Hounsfield Units (HU)",
y_breaks = seq(-500, 500, by = 50),  # Adjust y_breaks according to the actual range of your data
type = "HU"
)
# Extract the legend
g <- ggplotGrob(gg)
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen", "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 4, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen", "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 4, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen", "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 5, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 5, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 7, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 3, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 4, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 8, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 8, ncol = 1,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 10, ncol = 1,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 10, ncol = 3,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta","Cortex", "Infrarenal aorta","Medulla", "Inferior vena cava","Pelvis", "Infrarenal vena cava", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 10, ncol = 2,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
library(ggplot2)
library(grid)
# Define categories and their corresponding unique colors
categories <- c("Suprarenal abdominal aorta", "Infrarenal aorta", "Inferior vena cava", "Infrarenal vena cava" ,"Cortex","Medulla", "Pelvis", "Liver", "Spleen", "Pancreas")
colors <- c("Suprarenal abdominal aorta" = "red",
"Infrarenal aorta" = "pink",
"Inferior vena cava" = "blue",
"Infrarenal vena cava" = "lightblue",
"Cortex" = "purple",
"Medulla" = "orange",
"Pelvis" = "lightgreen",
"Liver" = "gold",
"Pancreas" = "cyan",
"Spleen"=  "hotpink")
# Create a dummy dataframe
data <- data.frame(Category = factor(categories, levels = categories))
# Create the plot with proper color mappings
gg <- ggplot(data, aes(x = 1, y = Category, fill = Category)) +
geom_tile() +  # using geom_tile to create colored boxes
scale_fill_manual(values = colors) +
theme_void() +
theme(legend.position = "bottom",
legend.text = element_text(size = 12, face = "bold"),  # Bold legend text
legend.box.spacing = unit(2, "lines"),  # Increase spacing between legend items
legend.spacing.x = unit(1, "cm"),  # Increase spacing between legend columns
legend.spacing.y = unit(1, "cm")) +  # Increase spacing between legend rows
guides(fill = guide_legend(title = "",
nrow = 10, ncol = 1,  # Specify the layout of the legend items
byrow = TRUE))  # Fill by rows first
# Extract the legend
g <- ggplotGrob(gg)
legend <- gtable::gtable_filter(g, "guide-box")
# Draw the legend
grid.newpage()
grid.draw(legend)
